"use strict";(self["webpackChunkyanchat_fontend"]=self["webpackChunkyanchat_fontend"]||[]).push([[665],{5665:function(e,n,t){t.r(n),t.d(n,{default:function(){return me}});t(7658);var o=t(3396),s=t(4870),a=t(9242),l=t(2483),r=t(7139),i=t(7150),u=t(3744),c=t(71),d=t(1015),p=t(5989),f=t(9619);const g='a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])',m=e=>{const n=getComputedStyle(e);return"fixed"!==n.position&&null!==e.offsetParent},v=e=>Array.from(e.querySelectorAll(g)).filter((e=>h(e)&&m(e))),h=e=>{if(e.tabIndex>0||0===e.tabIndex&&null!==e.getAttribute("tabIndex"))return!0;if(e.disabled)return!1;switch(e.nodeName){case"A":return!!e.href&&"ignore"!==e.rel;case"INPUT":return!("hidden"===e.type||"file"===e.type);case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},y="_trap-focus-children",b=[],C=e=>{if(0===b.length)return;const n=b[b.length-1][y];if(n.length>0&&e.code===f.n.tab){if(1===n.length)return e.preventDefault(),void(document.activeElement!==n[0]&&n[0].focus());const t=e.shiftKey,o=e.target===n[0],s=e.target===n[n.length-1];o&&t&&(e.preventDefault(),n[n.length-1].focus()),s&&!t&&(e.preventDefault(),n[0].focus())}},w={beforeMount(e){e[y]=v(e),b.push(e),b.length<=1&&document.addEventListener("keydown",C)},updated(e){(0,o.Y3)((()=>{e[y]=v(e)}))},unmounted(){b.shift(),0===b.length&&document.removeEventListener("keydown",C)}};var _=t(5554),k=t(2039),x=t(4961),E=t(3965),B=t(8925),T=t(4389),I=t(3319),M=t(3388);const S=(0,o.aZ)({name:"ElMessageBox",directives:{TrapFocus:w},components:{ElButton:i.mi,ElFocusTrap:_.Z,ElInput:u.EZ,ElOverlay:c.F6,ElIcon:d.gn,...k.TypeComponents},inheritAttrs:!1,props:{buttonSize:{type:String,validator:x.P},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(e,{emit:n}){const{locale:t,zIndex:a,ns:l,size:r}=(0,E.cU)("message-box",(0,o.Fl)((()=>e.buttonSize))),{t:i}=t,{nextZIndex:u}=a,c=(0,s.iH)(!1),d=(0,s.qj)({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:u()}),p=(0,o.Fl)((()=>{const e=d.type;return{[l.bm("icon",e)]:e&&k.Rp[e]}})),f=(0,B.Me)(),g=(0,B.Me)(),m=(0,o.Fl)((()=>d.icon||k.Rp[d.type]||"")),v=(0,o.Fl)((()=>!!d.message)),h=(0,s.iH)(),y=(0,s.iH)(),b=(0,s.iH)(),C=(0,s.iH)(),w=(0,s.iH)(),_=(0,o.Fl)((()=>d.confirmButtonClass));(0,o.YP)((()=>d.inputValue),(async n=>{await(0,o.Y3)(),"prompt"===e.boxType&&null!==n&&H()}),{immediate:!0}),(0,o.YP)((()=>c.value),(n=>{var t,s;n&&("prompt"!==e.boxType&&(d.autofocus?b.value=null!=(s=null==(t=w.value)?void 0:t.$el)?s:h.value:b.value=h.value),d.zIndex=u()),"prompt"===e.boxType&&(n?(0,o.Y3)().then((()=>{var e;C.value&&C.value.$el&&(d.autofocus?b.value=null!=(e=D())?e:h.value:b.value=h.value)})):(d.editorErrorMessage="",d.validateError=!1))}));const x=(0,o.Fl)((()=>e.draggable));function S(){c.value&&(c.value=!1,(0,o.Y3)((()=>{d.action&&n("action",d.action)})))}(0,T.O)(h,y,x),(0,o.bv)((async()=>{await(0,o.Y3)(),e.closeOnHashChange&&window.addEventListener("hashchange",S)})),(0,o.Jd)((()=>{e.closeOnHashChange&&window.removeEventListener("hashchange",S)}));const L=()=>{e.closeOnClickModal&&R(d.distinguishCancelAndClose?"close":"cancel")},z=(0,I.S)(L),A=e=>{if("textarea"!==d.inputType)return e.preventDefault(),R("confirm")},R=n=>{var t;("prompt"!==e.boxType||"confirm"!==n||H())&&(d.action=n,d.beforeClose?null==(t=d.beforeClose)||t.call(d,n,d,S):S())},H=()=>{if("prompt"===e.boxType){const e=d.inputPattern;if(e&&!e.test(d.inputValue||""))return d.editorErrorMessage=d.inputErrorMessage||i("el.messagebox.error"),d.validateError=!0,!1;const n=d.inputValidator;if("function"===typeof n){const e=n(d.inputValue);if(!1===e)return d.editorErrorMessage=d.inputErrorMessage||i("el.messagebox.error"),d.validateError=!0,!1;if("string"===typeof e)return d.editorErrorMessage=e,d.validateError=!0,!1}}return d.editorErrorMessage="",d.validateError=!1,!0},D=()=>{const e=C.value.$refs;return e.input||e.textarea},P=()=>{R("close")},q=()=>{e.closeOnPressEscape&&P()};return e.lockScroll&&(0,M.W)(c),{...(0,s.BK)(d),ns:l,overlayEvent:z,visible:c,hasMessage:v,typeClass:p,contentId:f,inputId:g,btnSize:r,iconComponent:m,confirmButtonClasses:_,rootRef:h,focusStartRef:b,headerRef:y,inputRef:C,confirmRef:w,doClose:S,handleClose:P,onCloseRequested:q,handleWrapperClick:L,handleInputEnter:A,handleAction:R,t:i}}}),L=["aria-label","aria-describedby"],z=["aria-label"],A=["id"];function R(e,n,t,s,l,i){const u=(0,o.up)("el-icon"),c=(0,o.up)("close"),d=(0,o.up)("el-input"),p=(0,o.up)("el-button"),f=(0,o.up)("el-focus-trap"),g=(0,o.up)("el-overlay");return(0,o.wg)(),(0,o.j4)(a.uT,{name:"fade-in-linear",onAfterLeave:n[11]||(n[11]=n=>e.$emit("vanish")),persisted:""},{default:(0,o.w5)((()=>[(0,o.wy)((0,o.Wm)(g,{"z-index":e.zIndex,"overlay-class":[e.ns.is("message-box"),e.modalClass],mask:e.modal},{default:(0,o.w5)((()=>[(0,o._)("div",{role:"dialog","aria-label":e.title,"aria-modal":"true","aria-describedby":e.showInput?void 0:e.contentId,class:(0,r.C_)(`${e.ns.namespace.value}-overlay-message-box`),onClick:n[8]||(n[8]=(...n)=>e.overlayEvent.onClick&&e.overlayEvent.onClick(...n)),onMousedown:n[9]||(n[9]=(...n)=>e.overlayEvent.onMousedown&&e.overlayEvent.onMousedown(...n)),onMouseup:n[10]||(n[10]=(...n)=>e.overlayEvent.onMouseup&&e.overlayEvent.onMouseup(...n))},[(0,o.Wm)(f,{loop:"",trapped:e.visible,"focus-trap-el":e.rootRef,"focus-start-el":e.focusStartRef,onReleaseRequested:e.onCloseRequested},{default:(0,o.w5)((()=>[(0,o._)("div",{ref:"rootRef",class:(0,r.C_)([e.ns.b(),e.customClass,e.ns.is("draggable",e.draggable),{[e.ns.m("center")]:e.center}]),style:(0,r.j5)(e.customStyle),tabindex:"-1",onClick:n[7]||(n[7]=(0,a.iM)((()=>{}),["stop"]))},[null!==e.title&&void 0!==e.title?((0,o.wg)(),(0,o.iD)("div",{key:0,ref:"headerRef",class:(0,r.C_)(e.ns.e("header"))},[(0,o._)("div",{class:(0,r.C_)(e.ns.e("title"))},[e.iconComponent&&e.center?((0,o.wg)(),(0,o.j4)(u,{key:0,class:(0,r.C_)([e.ns.e("status"),e.typeClass])},{default:(0,o.w5)((()=>[((0,o.wg)(),(0,o.j4)((0,o.LL)(e.iconComponent)))])),_:1},8,["class"])):(0,o.kq)("v-if",!0),(0,o._)("span",null,(0,r.zw)(e.title),1)],2),e.showClose?((0,o.wg)(),(0,o.iD)("button",{key:0,type:"button",class:(0,r.C_)(e.ns.e("headerbtn")),"aria-label":e.t("el.messagebox.close"),onClick:n[0]||(n[0]=n=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel")),onKeydown:n[1]||(n[1]=(0,a.D2)((0,a.iM)((n=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel")),["prevent"]),["enter"]))},[(0,o.Wm)(u,{class:(0,r.C_)(e.ns.e("close"))},{default:(0,o.w5)((()=>[(0,o.Wm)(c)])),_:1},8,["class"])],42,z)):(0,o.kq)("v-if",!0)],2)):(0,o.kq)("v-if",!0),(0,o._)("div",{id:e.contentId,class:(0,r.C_)(e.ns.e("content"))},[(0,o._)("div",{class:(0,r.C_)(e.ns.e("container"))},[e.iconComponent&&!e.center&&e.hasMessage?((0,o.wg)(),(0,o.j4)(u,{key:0,class:(0,r.C_)([e.ns.e("status"),e.typeClass])},{default:(0,o.w5)((()=>[((0,o.wg)(),(0,o.j4)((0,o.LL)(e.iconComponent)))])),_:1},8,["class"])):(0,o.kq)("v-if",!0),e.hasMessage?((0,o.wg)(),(0,o.iD)("div",{key:1,class:(0,r.C_)(e.ns.e("message"))},[(0,o.WI)(e.$slots,"default",{},(()=>[e.dangerouslyUseHTMLString?((0,o.wg)(),(0,o.j4)((0,o.LL)(e.showInput?"label":"p"),{key:1,for:e.showInput?e.inputId:void 0,innerHTML:e.message},null,8,["for","innerHTML"])):((0,o.wg)(),(0,o.j4)((0,o.LL)(e.showInput?"label":"p"),{key:0,for:e.showInput?e.inputId:void 0},{default:(0,o.w5)((()=>[(0,o.Uk)((0,r.zw)(e.dangerouslyUseHTMLString?"":e.message),1)])),_:1},8,["for"]))]))],2)):(0,o.kq)("v-if",!0)],2),(0,o.wy)((0,o._)("div",{class:(0,r.C_)(e.ns.e("input"))},[(0,o.Wm)(d,{id:e.inputId,ref:"inputRef",modelValue:e.inputValue,"onUpdate:modelValue":n[2]||(n[2]=n=>e.inputValue=n),type:e.inputType,placeholder:e.inputPlaceholder,"aria-invalid":e.validateError,class:(0,r.C_)({invalid:e.validateError}),onKeydown:(0,a.D2)(e.handleInputEnter,["enter"])},null,8,["id","modelValue","type","placeholder","aria-invalid","class","onKeydown"]),(0,o._)("div",{class:(0,r.C_)(e.ns.e("errormsg")),style:(0,r.j5)({visibility:e.editorErrorMessage?"visible":"hidden"})},(0,r.zw)(e.editorErrorMessage),7)],2),[[a.F8,e.showInput]])],10,A),(0,o._)("div",{class:(0,r.C_)(e.ns.e("btns"))},[e.showCancelButton?((0,o.wg)(),(0,o.j4)(p,{key:0,loading:e.cancelButtonLoading,class:(0,r.C_)([e.cancelButtonClass]),round:e.roundButton,size:e.btnSize,onClick:n[3]||(n[3]=n=>e.handleAction("cancel")),onKeydown:n[4]||(n[4]=(0,a.D2)((0,a.iM)((n=>e.handleAction("cancel")),["prevent"]),["enter"]))},{default:(0,o.w5)((()=>[(0,o.Uk)((0,r.zw)(e.cancelButtonText||e.t("el.messagebox.cancel")),1)])),_:1},8,["loading","class","round","size"])):(0,o.kq)("v-if",!0),(0,o.wy)((0,o.Wm)(p,{ref:"confirmRef",type:"primary",loading:e.confirmButtonLoading,class:(0,r.C_)([e.confirmButtonClasses]),round:e.roundButton,disabled:e.confirmButtonDisabled,size:e.btnSize,onClick:n[5]||(n[5]=n=>e.handleAction("confirm")),onKeydown:n[6]||(n[6]=(0,a.D2)((0,a.iM)((n=>e.handleAction("confirm")),["prevent"]),["enter"]))},{default:(0,o.w5)((()=>[(0,o.Uk)((0,r.zw)(e.confirmButtonText||e.t("el.messagebox.confirm")),1)])),_:1},8,["loading","class","round","disabled","size"]),[[a.F8,e.showConfirmButton]])],2)],6)])),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,L)])),_:3},8,["z-index","overlay-class","mask"]),[[a.F8,e.visible]])])),_:3})}var H=(0,p.Z)(S,[["render",R],["__file","/home/runner/work/element-plus/element-plus/packages/components/message-box/src/index.vue"]]),D=t(7354),P=t(4620),q=t(5413);const j=new Map,U=e=>{let n=document.body;return e.appendTo&&((0,r.HD)(e.appendTo)&&(n=document.querySelector(e.appendTo)),(0,D.kK)(e.appendTo)&&(n=e.appendTo),(0,D.kK)(n)||((0,P.N)("ElMessageBox","the appendTo option is not an HTMLElement. Falling back to document.body."),n=document.body)),n},O=(e,n,t=null)=>{const s=(0,o.Wm)(H,e,(0,r.mf)(e.message)||(0,o.lA)(e.message)?{default:(0,r.mf)(e.message)?e.message:()=>e.message}:null);return s.appContext=t,(0,a.sY)(s,n),U(e).appendChild(n.firstElementChild),s.component},V=()=>document.createElement("div"),$=(e,n)=>{const t=V();e.onVanish=()=>{(0,a.sY)(null,t),j.delete(s)},e.onAction=n=>{const t=j.get(s);let a;a=e.showInput?{value:s.inputValue,action:n}:n,e.callback?e.callback(a,o.proxy):"cancel"===n||"close"===n?e.distinguishCancelAndClose&&"cancel"!==n?t.reject("close"):t.reject("cancel"):t.resolve(a)};const o=O(e,t,n),s=o.proxy;for(const a in e)(0,r.RI)(e,a)&&!(0,r.RI)(s.$props,a)&&(s[a]=e[a]);return s.visible=!0,s};function F(e,n=null){if(!q.C5)return Promise.reject();let t;return(0,r.HD)(e)||(0,o.lA)(e)?e={message:e}:t=e.callback,new Promise(((o,s)=>{const a=$(e,null!=n?n:F._context);j.set(a,{options:e,callback:t,resolve:o,reject:s})}))}const W=["alert","confirm","prompt"],K={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};function Z(e){return(n,t,o,s)=>{let a="";return(0,r.Kn)(t)?(o=t,a=""):a=(0,D.o8)(t)?"":t,F(Object.assign({title:a,message:n,type:"",...K[e]},o,{boxType:e}),s)}}W.forEach((e=>{F[e]=Z(e)})),F.close=()=>{j.forEach(((e,n)=>{n.doClose()})),j.clear()},F._context=null;const Y=F;Y.install=e=>{Y._context=e._context,e.config.globalProperties.$msgbox=Y,e.config.globalProperties.$messageBox=Y,e.config.globalProperties.$alert=Y.alert,e.config.globalProperties.$confirm=Y.confirm,e.config.globalProperties.$prompt=Y.prompt};const N=Y;var J=t(4578),X=t(995),G=t(3625),Q=t(7633);const ee=e=>((0,o.dD)("data-v-4053627b"),e=e(),(0,o.Cn)(),e),ne={class:"container"},te={class:"login-box"},oe=ee((()=>(0,o._)("div",{class:"welcome"}," 欢迎登录 ",-1))),se={class:"login"},ae={class:"login-text"},le=ee((()=>(0,o._)("span",{class:"login-id"},"手机号:",-1))),re={class:"login-text"},ie=ee((()=>(0,o._)("span",{class:"login-id"},"密码:",-1))),ue={key:0,class:"pw-err"},ce={key:1,class:"pw-err"},de=ee((()=>(0,o._)("section",{class:"forget-pw"},null,-1)));var pe={__name:"loginToChat",setup(e){let n=(0,s.iH)(""),t=(0,s.iH)(""),r=(0,s.iH)(""),i=(0,s.iH)(!1),u=(0,s.iH)(!1);(0,o.bv)((()=>{n.value=(0,l.tv)()}));const c=(0,X.Z)((()=>{i.value=!0}),300),d=(0,X.Z)((()=>{u.value=!0}),300);async function p(){if(t.value&&r.value){const[e,o]=await(0,G.Z)((0,Q.W)({method:"post",url:Q.h.login,data:{phone_number:t.value,password:r.value}}));if(e)return void console.log("登录错误：",e);const{status:s,data:a}=o;if(200!==s)return;const{user_data:l,auth:p}=a;if(sessionStorage.setItem("Token",p?.token??""),sessionStorage.setItem("RefreshToken",p?.refreshToken??""),"repeat"===l)return u.value=!1,void d();if("pw_err"===l)return i.value=!1,void c();if(i.value=!1,"err"!==l)return console.log("user_info",l),sessionStorage.setItem("user_info",JSON.stringify(l)),sessionStorage.setItem("user_id",l.user_id),void n.value.push({name:"Chat"});N.confirm("当前用户尚未注册，是否自动注册并登录？","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((()=>{f(l)})).catch((e=>{console.log(e)}))}}async function f(){if(!/^1[345678]\d{9}$/.test(t.value))return void(0,J.z8)({message:`${t.value}: 电话号格式有误`,type:"error"});const[e,o]=await(0,G.Z)((0,Q.W)({method:"post",url:Q.h.register,data:{phone_number:t.value,password:r.value}}));if(e)return void console.log("注册错误：",e);const{status:s,data:a}=o;if(200===s){if("exist"===a)return;sessionStorage.setItem("user_info",JSON.stringify(a)),(0,J.z8)({message:`${t.value} 已经成功注册！`,type:"success"}),sessionStorage.setItem("user_id",a.user_id),n.value.push({name:"Chat"})}}return(e,n)=>((0,o.wg)(),(0,o.iD)("main",ne,[(0,o._)("section",te,[oe,(0,o._)("section",se,[(0,o._)("div",ae,[le,(0,o.wy)((0,o._)("input",{type:"text",placeholder:"请输入你的手机号","onUpdate:modelValue":n[0]||(n[0]=e=>(0,s.dq)(t)?t.value=e:t=e),class:"input"},null,512),[[a.nr,(0,s.SU)(t)]])]),(0,o._)("div",re,[ie,(0,o.wy)((0,o._)("input",{type:"password",placeholder:"请输入密码","onUpdate:modelValue":n[1]||(n[1]=e=>(0,s.dq)(r)?r.value=e:r=e),class:"input"},null,512),[[a.nr,(0,s.SU)(r)]]),(0,s.SU)(i)?((0,o.wg)(),(0,o.iD)("div",ue,"密码错误！")):(0,o.kq)("",!0),(0,s.SU)(u)?((0,o.wg)(),(0,o.iD)("div",ce,"重复登录！")):(0,o.kq)("",!0)])]),de,(0,o._)("section",null,[(0,o._)("div",null,[(0,o._)("button",{class:"login-in",onClick:p},"登录/注册")])])])]))}},fe=t(89);const ge=(0,fe.Z)(pe,[["__scopeId","data-v-4053627b"]]);var me=ge}}]);
//# sourceMappingURL=665.fad5e644.js.map